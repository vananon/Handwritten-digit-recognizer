<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reconocimiento de Dígitos - Machine Learning</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #eff6ff 0%, #e0e7ff 100%);
            min-height: 100vh;
            padding: 2rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .header h1 {
            font-size: 2.5rem;
            color: #1f2937;
            margin-bottom: 0.5rem;
            font-weight: bold;
        }

        .header p {
            color: #6b7280;
            font-size: 1rem;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        @media (min-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        .card {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            padding: 1.5rem;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }

        .card-subtitle {
            font-size: 0.875rem;
            color: #6b7280;
            margin-bottom: 1rem;
        }

        #canvas {
            border: 4px solid #d1d5db;
            border-radius: 0.5rem;
            cursor: crosshair;
            width: 100%;
            max-width: 400px;
            aspect-ratio: 1/1;
            touch-action: none;
            display: block;
        }

        .button-group {
            display: flex;
            gap: 0.75rem;
            margin-top: 1rem;
        }

        button {
            flex: 1;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 0.5rem;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            transition: background-color 0.2s;
        }

        .btn-clear {
            background: #ef4444;
            color: white;
        }

        .btn-clear:hover {
            background: #dc2626;
        }

        .btn-predict {
            background: #6366f1;
            color: white;
        }

        .btn-predict:hover {
            background: #4f46e5;
        }

        .prediction-main {
            background: linear-gradient(135deg, #6366f1 0%, #9333ea 100%);
            border-radius: 0.75rem;
            padding: 2rem;
            text-align: center;
            color: white;
            margin-bottom: 1.5rem;
        }

        .prediction-main .label {
            font-size: 1.125rem;
            opacity: 0.9;
            margin-bottom: 0.5rem;
        }

        .prediction-main .digit {
            font-size: 5rem;
            font-weight: bold;
            margin: 0.5rem 0;
        }

        .prediction-main .confidence {
            font-size: 1.125rem;
            opacity: 0.9;
        }

        .probabilities {
            margin-bottom: 1.5rem;
        }

        .probabilities h3 {
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.75rem;
        }

        .probability-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.5rem;
        }

        .probability-digit {
            width: 2rem;
            font-weight: 600;
            color: #374151;
        }

        .probability-bar-container {
            flex: 1;
            background: #e5e7eb;
            border-radius: 9999px;
            height: 1.5rem;
            overflow: hidden;
        }

        .probability-bar {
            height: 100%;
            border-radius: 9999px;
            transition: width 0.5s;
        }

        .probability-bar.active {
            background: linear-gradient(90deg, #6366f1 0%, #9333ea 100%);
        }

        .probability-bar.inactive {
            background: #9ca3af;
        }

        .probability-value {
            width: 4rem;
            font-size: 0.875rem;
            color: #6b7280;
            text-align: right;
        }

        .note {
            background: #dbeafe;
            border: 1px solid #93c5fd;
            border-radius: 0.5rem;
            padding: 1rem;
        }

        .note p {
            font-size: 0.875rem;
            color: #1e40af;
        }

        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 4rem 0;
            color: #9ca3af;
        }

        .empty-state svg {
            width: 6rem;
            height: 6rem;
            margin-bottom: 1rem;
        }

        .empty-state .title {
            font-size: 1.125rem;
            font-weight: 500;
            margin-bottom: 0.25rem;
        }

        .empty-state .subtitle {
            font-size: 0.875rem;
        }

        .info-section {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            padding: 1.5rem;
        }

        .info-section h3 {
            font-size: 1.125rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 0.75rem;
        }

        .info-section > p {
            color: #6b7280;
            margin-bottom: 1rem;
            line-height: 1.6;
        }

        .info-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }

        @media (min-width: 640px) {
            .info-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .info-card {
            border-radius: 0.5rem;
            padding: 1rem;
        }

        .info-card.tech {
            background: #eef2ff;
        }

        .info-card.model {
            background: #faf5ff;
        }

        .info-card.accuracy {
            background: #fdf2f8;
        }

        .info-card .info-title {
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .info-card.tech .info-title {
            color: #312e81;
        }

        .info-card.model .info-title {
            color: #581c87;
        }

        .info-card.accuracy .info-title {
            color: #831843;
        }

        .info-card .info-text {
            font-size: 0.75rem;
        }

        .info-card.tech .info-text {
            color: #4338ca;
        }

        .info-card.model .info-text {
            color: #6b21a8;
        }

        .info-card.accuracy .info-text {
            color: #9f1239;
        }

        .hidden {
            display: none;
        }

        .icon {
            width: 1.25rem;
            height: 1.25rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Reconocimiento de Dígitos</h1>
            <p>Dibuja un número del 0 al 9 y el modelo lo reconocerá</p>
        </div>

        <div class="main-grid">
            <!-- Panel de dibujo -->
            <div class="card">
                <h2 class="card-title">Dibuja aquí</h2>
                <p class="card-subtitle">Usa el mouse o tu dedo para dibujar un dígito</p>
                
                <canvas id="canvas" width="400" height="400"></canvas>
                
                <div class="button-group">
                    <button class="btn-clear" onclick="clearCanvas()">
                        <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                        </svg>
                        Limpiar
                    </button>
                    <button class="btn-predict" onclick="predictDigit()">
                        <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                        </svg>
                        Predecir
                    </button>
                </div>
            </div>

            <!-- Panel de predicción -->
            <div class="card">
                <h2 class="card-title">Predicción</h2>
                <p class="card-subtitle">Resultado del modelo de Machine Learning</p>
                
                <div id="emptyState" class="empty-state">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"/>
                    </svg>
                    <p class="title">Dibuja un dígito</p>
                    <p class="subtitle">El modelo lo reconocerá automáticamente</p>
                </div>

                <div id="predictionResults" class="hidden">
                    <div class="prediction-main">
                        <p class="label">Dígito detectado</p>
                        <p class="digit" id="predictedDigit">-</p>
                        <p class="confidence">Confianza: <span id="confidenceValue">0</span>%</p>
                    </div>

                    <div class="probabilities">
                        <h3>Probabilidades de cada dígito:</h3>
                        <div id="probabilitiesList"></div>
                    </div>

                    <div class="note">
                        <p><strong>Nota:</strong> Esta es una simulación. En una aplicación real, se usaría un modelo de deep learning entrenado con miles de imágenes de dígitos (como MNIST).</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Información adicional -->
        <div class="info-section">
            <h3>Sobre este proyecto</h3>
            <p>Este es un proyecto de Machine Learning que utiliza reconocimiento de dígitos manuscritos. En una implementación real, se utilizaría una red neuronal convolucional (CNN) entrenada con el dataset MNIST, que contiene 60,000 imágenes de entrenamiento de dígitos escritos a mano.</p>
            
            <div class="info-grid">
                <div class="info-card tech">
                    <p class="info-title">Tecnología</p>
                    <p class="info-text">HTML5 Canvas API para el dibujo interactivo</p>
                </div>
                <div class="info-card model">
                    <p class="info-title">Modelo típico</p>
                    <p class="info-text">CNN con TensorFlow o PyTorch entrenado en MNIST</p>
                </div>
                <div class="info-card accuracy">
                    <p class="info-title">Precisión esperada</p>
                    <p class="info-text">~99% con un modelo bien entrenado</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Variables globales
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let isDrawing = false;
        let prediction = null;
        let confidence = 0;
        let predictions = [];

        // Inicializar canvas
        function initCanvas() {
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 10;
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
        }

        // Obtener coordenadas
        function getCoordinates(e) {
            const rect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;
            
            if (e.touches) {
                return {
                    x: (e.touches[0].clientX - rect.left) * scaleX,
                    y: (e.touches[0].clientY - rect.top) * scaleY
                };
            }
            return {
                x: (e.clientX - rect.left) * scaleX,
                y: (e.clientY - rect.top) * scaleY
            };
        }

        // Iniciar dibujo
        function startDrawing(e) {
            isDrawing = true;
            const coords = getCoordinates(e);
            ctx.beginPath();
            ctx.moveTo(coords.x, coords.y);
        }

        // Dibujar
        function draw(e) {
            if (!isDrawing) return;
            e.preventDefault();
            const coords = getCoordinates(e);
            ctx.lineTo(coords.x, coords.y);
            ctx.stroke();
        }

        // Detener dibujo
        function stopDrawing() {
            if (isDrawing) {
                isDrawing = false;
                predictDigit();
            }
        }

        // Limpiar canvas
        function clearCanvas() {
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            prediction = null;
            confidence = 0;
            predictions = [];
            updateUI();
        }

        // Predecir dígito (simulación)
        function predictDigit() {
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;

            // Calcular características simples
            let pixelCount = 0;
            let centerMass = { x: 0, y: 0 };
            let topHalf = 0;
            let bottomHalf = 0;

            for (let y = 0; y < canvas.height; y++) {
                for (let x = 0; x < canvas.width; x++) {
                    const i = (y * canvas.width + x) * 4;
                    const brightness = (data[i] + data[i + 1] + data[i + 2]) / 3;

                    if (brightness < 200) {
                        pixelCount++;
                        centerMass.x += x;
                        centerMass.y += y;

                        if (y < canvas.height / 2) {
                            topHalf++;
                        } else {
                            bottomHalf++;
                        }
                    }
                }
            }

            if (pixelCount === 0) return;

            centerMass.x /= pixelCount;
            centerMass.y /= pixelCount;

            // Lógica simple para simular predicción
            const topBottomRatio = topHalf / (bottomHalf + 1);
            const centerY = centerMass.y / canvas.height;

            let predictedDigit;
            let conf;

            // Heurísticas simples basadas en características
            if (pixelCount < 1000) {
                predictedDigit = 1;
                conf = 0.92;
            } else if (topBottomRatio > 1.5) {
                predictedDigit = Math.random() > 0.5 ? 2 : 5;
                conf = 0.87;
            } else if (topBottomRatio < 0.6) {
                predictedDigit = Math.random() > 0.5 ? 6 : 9;
                conf = 0.85;
            } else if (centerY < 0.4) {
                predictedDigit = Math.random() > 0.5 ? 0 : 8;
                conf = 0.89;
            } else {
                predictedDigit = Math.floor(Math.random() * 10);
                conf = 0.75 + Math.random() * 0.15;
            }

            prediction = predictedDigit;
            confidence = conf;

            // Generar probabilidades para todos los dígitos
            predictions = [];
            for (let i = 0; i < 10; i++) {
                if (i === predictedDigit) {
                    predictions.push({ digit: i, probability: conf });
                } else {
                    predictions.push({ 
                        digit: i, 
                        probability: (1 - conf) / 9 + Math.random() * 0.05 
                    });
                }
            }
            predictions.sort((a, b) => b.probability - a.probability);

            updateUI();
        }

        // Actualizar UI
        function updateUI() {
            const emptyState = document.getElementById('emptyState');
            const results = document.getElementById('predictionResults');
            
            if (prediction === null) {
                emptyState.classList.remove('hidden');
                results.classList.add('hidden');
            } else {
                emptyState.classList.add('hidden');
                results.classList.remove('hidden');
                
                document.getElementById('predictedDigit').textContent = prediction;
                document.getElementById('confidenceValue').textContent = (confidence * 100).toFixed(1);
                
                const probabilitiesList = document.getElementById('probabilitiesList');
                probabilitiesList.innerHTML = '';
                
                predictions.forEach(pred => {
                    const item = document.createElement('div');
                    item.className = 'probability-item';
                    item.innerHTML = `
                        <span class="probability-digit">${pred.digit}</span>
                        <div class="probability-bar-container">
                            <div class="probability-bar ${pred.digit === prediction ? 'active' : 'inactive'}" 
                                 style="width: ${pred.probability * 100}%"></div>
                        </div>
                        <span class="probability-value">${(pred.probability * 100).toFixed(1)}%</span>
                    `;
                    probabilitiesList.appendChild(item);
                });
            }
        }

        // Event listeners
        canvas.addEventListener('mousedown', startDrawing);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('mouseup', stopDrawing);
        canvas.addEventListener('mouseleave', stopDrawing);
        canvas.addEventListener('touchstart', startDrawing);
        canvas.addEventListener('touchmove', draw);
        canvas.addEventListener('touchend', stopDrawing);

        // Inicializar
        initCanvas();
    </script>
</body>
</html>
